Import-Module ActiveDirectory

$logFile = "C:\Reports\phonebook.log"
"==== Run started $(Get-Date) ====" | Out-File $logFile -Encoding UTF8

$outFile  = "C:\Reports\cn.xml"
$htmlFile = "C:\Users\Administrator\Desktop\share\req\phonebook.html"
New-Item -ItemType Directory -Path (Split-Path $outFile) -Force | Out-Null

Add-Type -AssemblyName System.Web


$logosvg='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"  
      xmlns="http://www.w3.org/2000/svg"
       viewBox="0 0 2377 1567"
       preserveAspectRatio="xMidYMid meet">
<path d="M0 0 C784.41 0 1568.82 0 2377 0 C2377 517.11 2377 1034.22 2377 1567 C1592.59 1567 808.18 1567 0 1567 C0 1049.89 0 532.78 0 0 Z " fill="#FD0000" transform="translate(0,0)"/>
<path d="M0 0 C2.34171678 5.1881891 4.59964551 10.38197174 6.63671875 15.69921875 C6.87289917 16.31469574 7.10907959 16.93017273 7.35241699 17.56430054 C8.13377262 19.60423695 8.91095003 21.64572972 9.6875 23.6875 C9.96389313 24.41218475 10.24028625 25.13686951 10.52505493 25.8835144 C18.14066837 45.86029045 25.51397948 65.92728985 32.89324951 85.99224854 C34.34737685 89.94404588 35.80422013 93.89483943 37.26104736 97.84564209 C45.77235903 120.93179213 54.20048405 144.0468581 62.5625 167.1875 C71.59048497 192.16920214 80.74162181 217.10282647 90 242 C90.49762848 243.33819794 90.49762848 243.33819794 91.00531006 244.70343018 C93.33575207 250.96937088 95.66769789 257.23475147 98 263.5 C109.80806189 295.21992264 121.56156112 326.95632661 133.06384277 358.78868103 C142.58767664 385.14420964 152.24909352 411.43706785 162.15699387 437.65052414 C175.01846923 471.67925917 187.84601487 505.71014236 200 540 C200.29346313 540.82582581 200.58692627 541.65165161 200.88928223 542.50250244 C202.54860388 547.17303664 204.19817598 551.84676793 205.83010864 556.52694702 C206.30969525 557.90080008 206.79144577 559.27390012 207.27560425 560.64614868 C207.92207988 562.48270021 208.55707376 564.32328154 209.19140625 566.1640625 C209.72036499 567.68700928 209.72036499 567.68700928 210.26000977 569.24072266 C210.99423871 571.9785173 211.05592392 574.18557485 211 577 C156.0169144 579.16451929 101.02884883 580.32148797 46 580 C37.95259179 561.19268351 30.60424299 542.54090782 25.41796875 522.73779297 C22.45169058 511.59659342 18.68905867 500.71444231 14.95800781 489.81054688 C13.95845492 486.87811749 12.97846486 483.93952367 12 481 C10.36086388 481.00333092 10.36086388 481.00333092 8.68861389 481.00672913 C-5.52008185 481.03460701 -19.72878106 481.05197361 -33.9375 481.0625 C-35.08467121 481.06335602 -36.23184242 481.06421204 -37.4137764 481.06509399 C-72.2580787 481.0880174 -107.09575852 480.92710473 -141.9375 480.5 C-143.40161379 480.48206327 -143.40161379 480.48206327 -144.89530563 480.46376419 C-156.59701429 480.31949062 -168.29857099 480.1654072 -180 480 C-180.12719925 480.64329254 -180.2543985 481.28658508 -180.38545227 481.94937134 C-181.87591447 489.45078205 -183.50540259 496.91422732 -185.1875 504.375 C-185.33895477 505.04751801 -185.49040955 505.72003601 -185.64645386 506.41293335 C-188.087642 517.22981529 -190.70058557 527.9955669 -193.43530273 538.74243164 C-195.77725649 547.9801014 -197.92927209 557.25442793 -199.95922852 566.56567383 C-200.18408936 567.57138428 -200.4089502 568.57709473 -200.640625 569.61328125 C-200.83172852 570.48766846 -201.02283203 571.36205566 -201.21972656 572.26293945 C-202.18550859 575.65073117 -203.59347114 578.77361139 -205 582 C-205.99873138 582.01030746 -206.99746277 582.02061493 -208.02645874 582.03123474 C-267.76498495 582.63086557 -267.76498495 582.63086557 -327.5 583.5 C-328.58255066 583.51787567 -329.66510132 583.53575134 -330.78045654 583.5541687 C-341.35997233 583.73106767 -351.93615601 583.9575279 -362.5119791 584.29178697 C-389.32709279 585.13869215 -416.13827334 585.49958622 -442.96571541 585.65206528 C-450.88830924 585.69811054 -458.80957756 585.76601849 -466.73144531 585.88476562 C-473.74519429 585.98988039 -480.75803855 586.05628356 -487.77256858 586.07564378 C-491.4566041 586.08704773 -495.13823355 586.11691019 -498.82153702 586.19359589 C-502.90061897 586.27773526 -506.97523885 586.2748661 -511.05517578 586.26464844 C-512.25404922 586.30262543 -513.45292267 586.34060242 -514.68812561 586.37973022 C-519.72755704 586.30482846 -522.7604464 586.1978317 -526.48122787 582.60228729 C-528.52908205 579.81469638 -530.29132266 577.00456386 -532 574 C-532.88432874 572.69992563 -533.77916913 571.40676071 -534.6953125 570.12890625 C-535.50643695 568.94094212 -536.31631331 567.75212494 -537.125 566.5625 C-546.32775516 553.11282197 -555.67584435 539.76983266 -565.24560547 526.57861328 C-568.86963148 521.57946278 -572.44873147 516.55105628 -576 511.5 C-582.25425217 502.6091816 -588.6211563 493.8016686 -595 485 C-601.88264459 475.50317587 -608.7342194 465.9884349 -615.48071289 456.39428711 C-619.11460857 451.23409562 -622.79694174 446.11073708 -626.5 441 C-632.73953255 432.38398722 -638.88855169 423.70721152 -645 415 C-645.56364258 414.19771973 -646.12728516 413.39543945 -646.70800781 412.56884766 C-652.25095764 404.67680121 -657.79238158 396.78458978 -663.23266602 388.82128906 C-676.27430343 366.35489993 -676.27430343 366.35489993 -694 349 C-693.99861731 350.76697613 -693.99861731 350.76697613 -693.99720669 352.56964874 C-693.97554019 380.54423035 -693.95905515 408.51881129 -693.94893467 436.49339953 C-693.94768399 439.93798251 -693.94638967 443.38256548 -693.94506836 446.82714844 C-693.94467489 447.85576281 -693.94467489 447.85576281 -693.94427348 448.90515727 C-693.93992438 460.00278142 -693.93204099 471.10040039 -693.9228472 482.19802147 C-693.91348956 493.58858502 -693.90801474 504.97914472 -693.90591151 516.36971235 C-693.90460764 522.76617918 -693.90154217 529.16263424 -693.89426994 535.55909729 C-693.88747981 541.58033809 -693.88538916 547.60156228 -693.88689232 553.62280655 C-693.88661734 555.83187577 -693.88462998 558.04094554 -693.88079453 560.25001144 C-693.87581056 563.2687861 -693.87701908 566.28749827 -693.87974548 569.30627441 C-693.87537622 570.61369748 -693.87537622 570.61369748 -693.87091869 571.94753313 C-693.87290974 572.7646425 -693.87490079 573.58175187 -693.87695217 574.42362213 C-693.87657245 575.11926978 -693.87619273 575.81491742 -693.8758015 576.5316453 C-694.05216424 580.03672634 -694.56469821 583.51758571 -695 587 C-747.47 587 -799.94 587 -854 587 C-854.4375 514.875 -854.4375 514.875 -854.56811523 492.60107422 C-854.60561814 486.50227076 -854.64348548 480.40347384 -854.68359375 474.3046875 C-854.68895795 473.48884516 -854.69432214 472.67300282 -854.69984889 471.83243799 C-854.86233593 447.35594719 -855.12577469 422.8831481 -855.5049274 398.40910769 C-855.92561906 371.22885076 -856.21714053 344.04824586 -856.46894526 316.86591673 C-856.49992926 313.52325637 -856.53112582 310.18059806 -856.56237984 306.83794022 C-856.75397844 286.32705553 -856.94133253 265.81613297 -857.125 245.30517578 C-857.2169665 235.03803993 -857.31145974 224.77093018 -857.40851593 214.50384116 C-857.45907456 209.14271506 -857.50841345 203.78158484 -857.55444336 198.42041779 C-857.72550407 178.54709944 -857.94314039 158.686184 -858.5912168 138.82209134 C-859.04783771 124.76753062 -859.14654632 110.72528606 -859.1328125 96.6640625 C-859.13348943 94.14391063 -859.13446266 91.62375883 -859.13571167 89.10360718 C-859.13716226 83.90955971 -859.13511568 78.71552977 -859.13037109 73.52148438 C-859.12516587 67.53259029 -859.12676249 61.54373982 -859.1321975 55.55484927 C-859.13727566 49.72207226 -859.13675018 43.88930804 -859.13381577 38.05653 C-859.13315005 35.59809743 -859.13396248 33.139664 -859.13629532 30.68123245 C-859.13882521 27.27786167 -859.13498053 23.87455722 -859.12939453 20.47119141 C-859.13141876 19.46365311 -859.13344299 18.45611481 -859.13552856 17.41804504 C-859.13270874 16.49405411 -859.12988892 15.57006317 -859.12698364 14.61807251 C-859.12660662 13.81786997 -859.12622959 13.01766743 -859.12584114 12.19321632 C-859.0002918 10.00508569 -858.5581123 8.11267424 -858 6 C-827.35178966 5.87070937 -796.7035726 5.74315374 -766.05534586 5.61781773 C-762.38553 5.60280857 -758.7157142 5.58778554 -755.04589844 5.57275391 C-754.31571434 5.56976329 -753.58553025 5.56677268 -752.83321936 5.56369144 C-742.64368292 5.52192957 -732.45414982 5.47942447 -722.26461902 5.43630588 C-687.41427113 5.28887367 -652.56391696 5.15362958 -617.71344972 5.03738689 C-609.8431689 5.01075793 -601.97291484 4.97993417 -594.10266113 4.94628906 C-585.68021988 4.91035315 -577.25779619 4.88114274 -568.8352977 4.86259127 C-564.80725447 4.85360546 -560.77929169 4.84174102 -556.75129318 4.82041931 C-512.51394675 4.59259249 -512.51394675 4.59259249 -491.1875 9.1875 C-489.65416016 9.50895996 -489.65416016 9.50895996 -488.08984375 9.83691406 C-455.53979819 16.99266102 -426.99012286 33.50602113 -408.42822266 61.70214844 C-396.23917437 81.3129728 -388.59533587 101.48430615 -384 124 C-383.60506348 125.82217041 -383.60506348 125.82217041 -383.20214844 127.68115234 C-380.98930815 138.45130977 -380.5347201 148.95107407 -380.60888672 159.92773438 C-380.62490621 162.73357333 -380.60897417 165.53795548 -380.58984375 168.34375 C-380.56949598 186.25282238 -382.54765124 203.88660656 -388 221 C-388.24234375 221.76666992 -388.4846875 222.53333984 -388.734375 223.32324219 C-392.51710575 235.10255448 -397.0774413 246.14147593 -403 257 C-403.57621094 258.07894531 -404.15242188 259.15789062 -404.74609375 260.26953125 C-421.28576294 290.02565665 -449.90944714 308.60214335 -482.01074219 317.86914062 C-490.27993764 320.14941052 -498.57719913 322.36186914 -507 324 C-498.5032603 338.00813842 -489.26960799 351.49549878 -480 365 C-479.00758188 366.45036306 -478.01536313 367.90086258 -477.0234375 369.3515625 C-470.46382401 378.93205063 -463.82443033 388.4573703 -457.1875 397.984375 C-454.4111683 401.97017209 -451.6405791 405.95986011 -448.875 409.953125 C-442.25027137 419.51186598 -435.57756235 429.02433489 -428.72851562 438.42382812 C-424.81485404 443.8154439 -421.04732729 449.29587507 -417.3125 454.8125 C-413.68389783 460.16918702 -409.99391034 465.40921606 -406 470.5 C-400.15325649 477.9576777 -394.89719217 485.80074221 -389.59179688 493.6484375 C-375.66262644 518.07723741 -375.66262644 518.07723741 -357 537 C-356.8625386 536.42685059 -356.72507721 535.85370117 -356.58345032 535.26318359 C-356.01865917 533.07237828 -355.36617698 530.93971639 -354.66479492 528.7890625 C-354.26383858 527.55627563 -354.26383858 527.55627563 -353.8547821 526.29858398 C-353.5662587 525.41630127 -353.27773529 524.53401855 -352.98046875 523.625 C-352.68062576 522.70468994 -352.38078278 521.78437988 -352.07185364 520.83618164 C-351.43615386 518.8858598 -350.79979995 516.93575107 -350.1628418 514.98583984 C-349.20029815 512.03917931 -348.23960712 509.09192031 -347.27929688 506.14453125 C-345.52444465 500.76140735 -343.76420104 495.38006687 -342 490 C-341.59217285 488.75605469 -341.1843457 487.51210938 -340.76416016 486.23046875 C-340.42562012 485.20566406 -340.08708008 484.18085937 -339.73828125 483.125 C-339.46669189 482.30257813 -339.19510254 481.48015625 -338.9152832 480.6328125 C-338.17937088 478.5159604 -337.39961919 476.41437402 -336.60602474 474.31846428 C-335.10862291 470.33280483 -333.726884 466.31323838 -332.38832092 462.27175903 C-332.14356677 461.53693987 -331.89881262 460.8021207 -331.64664167 460.04503429 C-330.83469432 457.60617945 -330.0248961 455.16661666 -329.21508789 452.72705078 C-328.63014868 450.96867333 -328.04506699 449.21034328 -327.45985413 447.45205688 C-326.20351098 443.67649547 -324.94807312 439.90063469 -323.69331551 436.12454605 C-321.70699869 430.14724302 -319.71804282 424.17082024 -317.72862244 418.19454956 C-312.07309254 401.20385387 -306.42109901 384.21198291 -300.77172852 367.21923828 C-297.6488151 357.82590316 -294.52372367 348.43329542 -291.39632028 339.0414542 C-289.42047568 333.10739936 -287.4473321 327.17245562 -285.47621739 321.23682809 C-284.24661404 317.53624046 -283.01447501 313.83650078 -281.78163719 310.13698959 C-281.21301987 308.42900062 -280.64542804 306.72066983 -280.07897186 305.01196289 C-277.52561775 297.31146385 -274.95877851 289.65236356 -271.86222935 282.14870453 C-270.43093573 278.58187271 -269.26587661 274.93609729 -268.09838867 271.27612305 C-267.70512233 270.0592213 -267.70512233 270.0592213 -267.30391121 268.81773567 C-266.7389023 267.06885705 -266.17533545 265.31951198 -265.61309242 263.5697422 C-264.07119398 258.77345307 -262.5164768 253.98131994 -260.96240234 249.18896484 C-260.63831674 248.18896485 -260.31423113 247.18896486 -259.98032475 246.15866184 C-256.43068242 235.2200461 -252.80972604 224.3053826 -249.17578125 213.39453125 C-248.8522958 212.42321133 -248.52881035 211.4518914 -248.19552231 210.45113754 C-246.56213162 205.54810571 -244.92725018 200.64557316 -243.29125977 195.7434082 C-241.61058722 190.70722515 -239.93272491 185.67011053 -238.2555666 180.63275623 C-236.93979101 176.68181921 -235.62258979 172.73135863 -234.30495262 168.7810421 C-233.68457357 166.92056589 -233.06462994 165.05994442 -232.44515419 163.19916725 C-231.58899488 160.62814004 -230.73090661 158.05776444 -229.87231445 155.48754883 C-229.62457275 154.7422995 -229.37683105 153.99705017 -229.12158203 153.22921753 C-227.72955126 149.0697355 -226.24805933 144.95631725 -224.69325542 140.85503674 C-223.72056661 138.25228252 -222.83722967 135.62357283 -221.96289062 132.98632812 C-221.59240601 131.87157104 -221.22192139 130.75681396 -220.84020996 129.60827637 C-220.44950317 128.42785767 -220.05879639 127.24743896 -219.65625 126.03125 C-219.02915093 124.14416625 -218.40205011 122.25708308 -217.77484894 120.37003326 C-216.68194406 117.08044959 -215.59102838 113.79020642 -214.5 110.5 C-213.19679299 106.56992803 -211.89322168 102.63997976 -210.58728027 98.71081543 C-209.77669806 96.27158919 -208.96746831 93.83191297 -208.15979004 91.39172363 C-206.43736672 86.20909664 -204.6804469 81.05700512 -202.72991943 75.95593262 C-201.22851828 71.93269478 -199.89087719 67.85150125 -198.5234375 63.78125 C-197.8499288 61.7865407 -197.17617304 59.79191481 -196.50219727 57.79736328 C-196.15424103 56.76677795 -195.80628479 55.73619263 -195.44778442 54.67437744 C-185.51754188 25.29071265 -185.51754188 25.29071265 -180.5625 12.125 C-180.20397949 11.17173828 -179.84545898 10.21847656 -179.47607422 9.23632812 C-177.14595734 3.14595734 -177.14595734 3.14595734 -176 2 C-174.49836629 1.84761677 -172.98989996 1.76189708 -171.48168945 1.70336914 C-170.51168503 1.66432968 -169.5416806 1.62529022 -168.5422821 1.58506775 C-167.47258682 1.54797195 -166.40289154 1.51087616 -165.30078125 1.47265625 C-164.18093338 1.43133072 -163.06108551 1.39000519 -161.90730286 1.34742737 C-149.02242516 0.89526504 -136.13439471 0.65510604 -123.24328995 0.46757126 C-121.15545519 0.43703126 -119.06764203 0.40523675 -116.97982788 0.37332153 C-77.98921988 -0.21381092 -38.99379791 -0.09583028 0 0 Z " fill="#FEFEFE" transform="translate(2055,137)"/>
<path d="M0 0 C5.86526177 15.47205369 11.54737498 31.00079034 17.08129883 46.59423828 C19.2530319 52.71195393 21.43221138 58.82701398 23.61328125 64.94140625 C23.83687443 65.56831486 24.06046761 66.19522346 24.29083633 66.8411293 C29.13418157 80.4158444 34.06060171 93.95998009 39 107.5 C45.6925718 125.85122254 52.31857565 144.22469145 58.875 162.625 C65.91780598 182.38977906 73.00056818 202.13953568 80.125 221.875 C80.35628853 222.51573833 80.58757706 223.15647667 80.82587433 223.81663132 C82.89830239 229.55786051 84.97096981 235.29900327 87.04397583 241.0400238 C91.45356532 253.25312166 95.85305892 265.46984377 100.25 277.6875 C100.98453519 279.72835379 101.71907294 281.76920666 102.45361328 283.81005859 C103.90729869 287.84909514 105.36089744 291.88816286 106.81445312 295.92724609 C110.1658504 305.23975063 113.51847168 314.55181453 116.87097168 323.86392212 C118.74736183 329.07593102 120.62367723 334.28796684 122.5 339.5 C123.24999964 341.58333346 123.99999964 343.6666668 124.75 345.75 C138.25 383.25 151.75 420.75 165.25 458.25 C165.62121979 459.2811644 165.99243958 460.3123288 166.37490845 461.3747406 C167.12521795 463.45893704 167.87552312 465.54313504 168.62582397 467.62733459 C170.49605327 472.82247511 172.3663567 478.01758892 174.23681641 483.21264648 C177.66875483 492.74482621 181.10007756 502.27722574 184.52871704 511.81059265 C186.09309067 516.16020068 187.65789634 520.50965323 189.22271729 524.85910034 C189.98575455 526.9803795 190.74857493 529.10173668 191.51116943 531.22317505 C195.24653221 541.61433245 198.99048346 552.00180627 202.796875 562.3671875 C203.0857962 563.15534348 203.37471741 563.94349945 203.6723938 564.75553894 C204.99223822 568.35564071 206.31629585 571.95404535 207.64990234 575.54907227 C208.32206787 577.3790979 208.32206787 577.3790979 209.0078125 579.24609375 C209.39598145 580.29466553 209.78415039 581.3432373 210.18408203 582.42358398 C211 585 211 585 211 588 C174.14972569 588.76365393 137.30294598 589.24374186 100.44604492 589.53222656 C93.92625248 589.58388168 87.40648733 589.63878947 80.88671875 589.69335938 C68.25783617 589.79861472 55.62892917 589.90050182 43 590 C34.91403151 566.39226476 26.86170464 542.77437194 18.97167969 519.1003418 C17.81382964 515.62668583 16.65170309 512.15447395 15.48880959 508.6825037 C14.5740521 505.94926487 13.66197111 503.21513874 12.75068283 500.4807415 C12.11651661 498.57997766 11.47963184 496.68012151 10.84268188 494.7802887 C10.46743378 493.65146774 10.09218567 492.52264679 9.70556641 491.35961914 C9.37473053 490.36853653 9.04389465 489.37745392 8.70303345 488.3563385 C8 486 8 486 8 484 C7.39747343 484.0145394 6.79494686 484.02907881 6.17416191 484.0440588 C-8.83550138 484.40607908 -23.84523036 484.7652482 -38.85502815 485.12164211 C-46.11513474 485.29408822 -53.37521993 485.46734379 -60.63525391 485.64282227 C-101.08796534 486.61999523 -141.53962885 487.41454433 -182 488 C-182.06040466 488.5990213 -182.12080933 489.1980426 -182.18304443 489.81521606 C-182.30851654 491.00907425 -182.30851654 491.00907425 -182.43652344 492.22705078 C-182.55806793 493.40402023 -182.55806793 493.40402023 -182.68206787 494.60476685 C-183.19324901 498.45589703 -184.20987337 502.13817517 -185.25 505.875 C-185.70468009 507.55201476 -186.15909994 509.22910009 -186.61328125 510.90625 C-186.8448291 511.75316406 -187.07637695 512.60007812 -187.31494141 513.47265625 C-187.96865013 515.88434288 -188.60397005 518.2998674 -189.23046875 520.71875 C-191.36899429 528.97477568 -193.6166497 537.18616954 -196 545.375 C-198.3202568 553.36740708 -200.34863943 561.39804924 -202.23730469 569.50244141 C-203.50448395 574.93808232 -204.82306345 580.35394408 -206.25 585.75 C-206.56453125 586.94109375 -206.8790625 588.1321875 -207.203125 589.359375 C-208 592 -208 592 -209 593 C-211.63668113 593.11032637 -214.24771272 593.15496808 -216.88536072 593.15821838 C-217.72382406 593.16315884 -218.5622874 593.16809929 -219.42615873 593.17318946 C-222.26579322 593.18867197 -225.10540457 593.19696501 -227.94506836 593.20532227 C-229.97996847 593.21486662 -232.01486662 593.22483674 -234.04976273 593.23520088 C-239.63641898 593.26236339 -245.22308417 593.28323974 -250.80977035 593.30314612 C-256.74822257 593.32545292 -262.68664624 593.35380918 -268.62507629 593.38130188 C-293.25631131 593.49270496 -317.88764913 593.57416013 -342.5190146 593.65037918 C-350.39344021 593.67479298 -358.26786431 593.69969367 -366.14228809 593.72468996 C-372.69364878 593.74544914 -379.24501024 593.76574589 -385.79637527 593.78508759 C-415.82520091 593.87474309 -445.84990426 594.03893631 -475.87644941 594.42427677 C-481.76524362 594.49905837 -487.65405962 594.56263816 -493.54307556 594.61714172 C-494.33885968 594.62451365 -495.13464379 594.63188557 -495.95454258 594.63948089 C-499.82750022 594.67487989 -503.70046787 594.70865858 -507.57345104 594.7411356 C-515.55952683 594.81042767 -523.54310588 594.91974447 -531.52786249 595.08095759 C-537.47461943 595.19742518 -543.42070735 595.24825615 -549.36859703 595.27290916 C-551.73329619 595.29369202 -554.09793142 595.33677902 -556.46174049 595.4049015 C-573.34869177 595.87940851 -573.34869177 595.87940851 -577.76684761 592.74755096 C-581.11327161 589.30640797 -582.97732829 585.3319371 -585 581 C-586.29804934 579.1656776 -587.63402427 577.35679611 -589.02734375 575.59375 C-589.66905518 574.75465088 -590.3107666 573.91555176 -590.97192383 573.05102539 C-591.62056396 572.20918701 -592.2692041 571.36734863 -592.9375 570.5 C-593.97716919 569.14346313 -593.97716919 569.14346313 -595.0378418 567.75952148 C-596.40701588 565.97389893 -597.77748551 564.18926883 -599.14941406 562.40576172 C-600.72504503 560.35744147 -602.2972944 558.30662413 -603.8671875 556.25390625 C-609.3885792 549.04196402 -614.99140851 541.89535559 -620.61328125 534.76171875 C-621.98417682 533.02010212 -623.35199991 531.27612115 -624.71875 529.53125 C-629.94807012 522.85754295 -635.21590141 516.21676474 -640.52148438 509.60351562 C-643.85466461 505.44456687 -647.15477183 501.26133836 -650.4375 497.0625 C-654.94258923 491.30382072 -659.54116145 485.6257169 -664.16381836 479.96118164 C-668.11241123 475.1144637 -671.98862126 470.21632716 -675.8359375 465.2890625 C-679.33776247 460.81563292 -682.90811164 456.40132798 -686.5 452 C-691.00759973 446.47660315 -695.44842642 440.90815564 -699.8359375 435.2890625 C-703.87919062 430.12398193 -708.01847247 425.04000757 -712.16625977 419.95874023 C-716.08666081 415.14741805 -719.92982077 410.28170392 -723.74365234 405.38574219 C-728.21750712 399.66978471 -732.84637773 394.08325778 -737.49389648 388.50805664 C-738.06567627 387.8196167 -738.63745605 387.13117676 -739.2265625 386.421875 C-739.73783691 385.80924805 -740.24911133 385.19662109 -740.77587891 384.56542969 C-742 383 -742 383 -743 381 C-743 451.95 -743 522.9 -743 596 C-795.47 596 -847.94 596 -902 596 C-903.14881284 550.04748637 -903.14881284 550.04748637 -903.24951172 535.8996582 C-903.26426874 534.19644197 -903.27932938 532.49322835 -903.29465294 530.79001713 C-903.32655932 527.17876376 -903.35652556 523.5675023 -903.38480377 519.95621872 C-903.43136755 514.02136787 -903.48312086 508.08656733 -903.53533936 502.15176392 C-903.61157787 493.44216236 -903.685986 484.73254708 -903.75909424 476.0229187 C-903.96010666 452.1167578 -904.17378982 428.21070954 -904.390625 404.3046875 C-904.40204104 403.04255991 -904.41345708 401.78043231 -904.42521906 400.48005843 C-904.81777997 357.12496721 -905.27670134 313.7708398 -905.77085775 270.4167985 C-905.8055044 267.37525986 -905.84006145 264.3337202 -905.87461773 261.29218053 C-906.19675307 232.94106675 -906.52169441 204.58998649 -906.85763478 176.23903263 C-906.99932659 164.28014059 -907.13854603 152.32122164 -907.27564621 140.36227608 C-907.35011672 133.8756019 -907.42592123 127.38894852 -907.50530243 120.90233231 C-907.52017315 119.67728505 -907.53504386 118.45223779 -907.55036521 117.19006789 C-907.5773294 114.97647319 -907.6046566 112.76288286 -907.6325438 110.5492996 C-908.04738745 76.36087524 -908 42.19610886 -908 8 C-854.87 8 -801.74 8 -747 8 C-747 79.94 -747 151.88 -747 226 C-740.74213901 220.66693625 -740.74213901 220.66693625 -735.875 214.625 C-732.26501983 209.66434697 -728.51469419 204.8693216 -724.625 200.125 C-720.54862222 195.14551148 -716.51639316 190.13980787 -712.5625 185.0625 C-707.88021746 179.05767498 -703.05011455 173.18339056 -698.19384766 167.31884766 C-694.08870595 162.35064851 -690.07466183 157.32146872 -686.11328125 152.23828125 C-682.63146023 147.77910696 -679.07751928 143.38265769 -675.5 139 C-671.45017933 134.03767756 -667.44194806 129.0484598 -663.5 124 C-659.01736805 118.25908539 -654.43955976 112.60112223 -649.83374023 106.95874023 C-646.36106518 102.69689091 -642.94173694 98.39868899 -639.5625 94.0625 C-634.8799785 88.05785478 -630.05012135 82.18339877 -625.19384766 76.31884766 C-621.08870595 71.35064851 -617.07466183 66.32146872 -613.11328125 61.23828125 C-609.63146023 56.77910696 -606.07751928 52.38265769 -602.5 48 C-597.99826792 42.4839419 -593.56250635 36.92341091 -589.18164062 31.31103516 C-584.9670236 25.92586209 -580.6550051 20.62172735 -576.32617188 15.328125 C-575.80603516 14.69132813 -575.28589844 14.05453125 -574.75 13.3984375 C-574.29109375 12.83817871 -573.8321875 12.27791992 -573.359375 11.70068359 C-571.91333499 10.0003996 -571.91333499 10.0003996 -570.8503418 7.82348633 C-567.91959964 4.93528034 -564.53846919 5.41655566 -560.64453125 5.42578125 C-559.75820511 5.4119339 -558.87187897 5.39808655 -557.95869446 5.38381958 C-554.90988244 5.3411151 -551.86156789 5.32710843 -548.8125 5.3125 C-546.58510365 5.28762297 -544.35772684 5.26094553 -542.13037109 5.23266602 C-537.02756937 5.17136697 -531.92476968 5.12273822 -526.82177734 5.08105469 C-517.93403864 5.00680278 -509.04707923 4.8860674 -500.15989494 4.7635994 C-453.77184136 4.12795154 -407.39214007 3.84601597 -361 4 C-362.29325332 7.35634536 -363.52255232 9.95123995 -365.8359375 12.71484375 C-366.68128052 13.73324341 -366.68128052 13.73324341 -367.54370117 14.7722168 C-368.45019409 15.84403198 -368.45019409 15.84403198 -369.375 16.9375 C-370.00059814 17.68749268 -370.62619629 18.43748535 -371.27075195 19.21020508 C-375.68454489 24.48675232 -380.16991278 29.70081919 -384.67163086 34.90234375 C-388.04769122 38.82546392 -391.27000821 42.84479583 -394.4375 46.9375 C-398.86907763 52.66272799 -403.52819551 58.14900602 -408.2956543 63.59643555 C-412.99017544 68.964308 -417.5188601 74.45271529 -422 80 C-427.23574907 86.44545282 -432.53383495 92.83020484 -437.90917969 99.15917969 C-442.3405996 104.38447188 -446.67844842 109.68355885 -451 115 C-455.73316225 120.82281111 -460.50416573 126.60470548 -465.375 132.3125 C-469.1578153 136.74861488 -472.80532258 141.26600025 -476.375 145.875 C-480.82926201 151.61865365 -485.50929095 157.1273402 -490.29541016 162.59619141 C-494.9900572 167.96410722 -499.51878809 173.45262615 -504 179 C-508.77775812 184.88164447 -513.59476663 190.7244422 -518.5 196.5 C-522.55067245 201.2700028 -526.54630805 206.07938484 -530.49609375 210.93359375 C-532.41776017 213.28696059 -534.34759522 215.63242767 -536.28515625 217.97265625 C-541.82996944 224.67346602 -547.34656979 231.38502625 -552.6875 238.25 C-556.67696792 243.37618903 -560.7925628 248.37243664 -565.01196289 253.31079102 C-567.93353665 256.73054464 -570.79582167 260.19032122 -573.625 263.6875 C-577.90798427 268.95409911 -582.41128746 273.99906269 -587 279 C-585.39101334 284.33506102 -581.92001535 288.2196912 -578.5 292.5 C-577.22234632 294.11954721 -575.94500417 295.73934024 -574.66796875 297.359375 C-574.04067871 298.15150391 -573.41338867 298.94363281 -572.76708984 299.75976562 C-570.42013829 302.73512172 -568.11462378 305.7398156 -565.8125 308.75 C-558.15038047 318.7245047 -550.34922774 328.58562801 -542.47875977 338.39624023 C-539.14544273 342.55522652 -535.84529868 346.73857146 -532.5625 350.9375 C-528.05741077 356.69617928 -523.45883855 362.3742831 -518.83618164 368.03881836 C-514.88758877 372.8855363 -511.01137874 377.78367284 -507.1640625 382.7109375 C-503.12080938 387.87601807 -498.98152753 392.95999243 -494.83374023 398.04125977 C-491.36106518 402.30310909 -487.94173694 406.60131101 -484.5625 410.9375 C-479.88160799 416.94005563 -475.05454024 422.8134431 -470.19824219 428.67456055 C-466.50022388 433.14798615 -462.87507934 437.66816111 -459.3125 442.25 C-455.30029452 447.40760528 -451.15106047 452.42460345 -446.90893555 457.39428711 C-443.59766058 461.27726746 -440.3842435 465.22363857 -437.21484375 469.22265625 C-434.39900141 472.75363316 -431.54191309 476.25018734 -428.6875 479.75 C-424.59413316 484.77343714 -420.54638269 489.82685516 -416.5625 494.9375 C-411.34434478 501.62400871 -405.95442011 508.16232084 -400.55078125 514.69921875 C-392.07438391 524.95475606 -383.71923186 535.30020718 -375.5234375 545.78125 C-372.05282891 550.21724627 -368.52715696 554.60893365 -365 559 C-362.32244792 552.4831612 -359.8821812 545.93292015 -357.66824055 539.24523067 C-357.35664076 538.3121398 -357.04504096 537.37904892 -356.72399876 536.41768256 C-355.68524587 533.30470092 -354.65077461 530.19031395 -353.61628723 527.07591248 C-352.86309235 524.81576752 -352.10963133 522.55571123 -351.35592765 520.2957359 C-349.72026892 515.38922692 -348.08646625 510.48210404 -346.45431137 505.57442856 C-344.0273444 498.27690457 -341.59689838 490.98054265 -339.1657245 483.68441928 C-335.07551895 471.40913949 -330.98802098 459.13295977 -326.90198708 446.85629082 C-321.32462531 430.09898304 -315.74331863 413.34299111 -310.16096135 396.58734692 C-307.55977442 388.77977407 -304.95878036 380.97213697 -302.35783672 373.16448307 C-302.09749587 372.38297849 -301.83715502 371.6014739 -301.56892505 370.79628736 C-295.3760466 352.20603612 -289.18505806 333.61515559 -282.99438477 315.02416992 C-282.7235857 314.21094543 -282.45278663 313.39772094 -282.17378154 312.55985329 C-278.05328231 300.18575952 -273.93288149 287.81163298 -269.8125 275.4375 C-265.41322517 262.22581081 -261.01391093 249.01413475 -256.61450195 235.80249023 C-256.34339295 234.98833403 -256.07228394 234.17417783 -255.7929595 233.33535023 C-249.60682238 214.75805276 -243.42014859 196.18093425 -237.23178387 177.6043787 C-236.97194148 176.82436955 -236.71209909 176.04436041 -236.4443827 175.24071462 C-233.85089037 167.4554679 -231.25730391 159.67025255 -228.66357668 151.88508409 C-223.08575099 135.14296362 -217.50958695 118.4002923 -211.93675066 101.65651032 C-207.87742384 89.46020327 -203.81606228 77.26457548 -199.75254659 65.0696634 C-197.3357178 57.81633814 -194.92060659 50.56244605 -192.50787516 43.30775681 C-190.71108292 37.90569536 -188.91120803 32.50466525 -187.11008938 27.10404492 C-186.37832038 24.90819104 -185.64758706 22.71199172 -184.9179462 20.51542979 C-183.93278278 17.55009775 -182.9440033 14.58599699 -181.95423603 11.62219906 C-181.66601556 10.75171194 -181.3777951 9.88122481 -181.08084068 8.98435929 C-179.11414139 3.11414139 -179.11414139 3.11414139 -178 2 C-175.30801499 1.84429375 -172.63930651 1.7531902 -169.94458008 1.70288086 C-169.09288364 1.68323336 -168.24118721 1.66358585 -167.36368179 1.64334297 C-164.49905123 1.57878767 -161.6343258 1.52162425 -158.76953125 1.46484375 C-156.73977661 1.42157879 -154.71002714 1.378071 -152.68028259 1.33433533 C-147.19616115 1.21816544 -141.71191205 1.10977317 -136.22758484 1.00380707 C-132.82710927 0.93778365 -129.42667586 0.86986465 -126.02624512 0.80157471 C-84.01439448 -0.03535533 -42.01852152 -0.24712822 0 0 Z " fill="#FEFEFE" transform="translate(1990,793)"/>
<path d="M0 0 C1.50796143 0.28037109 1.50796143 0.28037109 3.04638672 0.56640625 C23.4866088 4.42507429 43.84652114 11.96301706 62.08251953 21.95507812 C64.17573747 23.0957673 66.28796263 24.19594968 68.40234375 25.296875 C79.0580667 30.93032171 88.60899029 37.46144961 98 45 C98.82395264 45.6504126 98.82395264 45.6504126 99.66455078 46.31396484 C114.25345415 57.88200158 127.80573376 71.28356739 138.78515625 86.33642578 C140.00570603 88.00781369 141.25102809 89.65837503 142.5 91.30859375 C149.00394135 100.02488942 154.45952881 109.27806418 159.75097656 118.76904297 C160.84490292 120.72297164 161.96069424 122.66168894 163.0859375 124.59765625 C181.79408337 157.85234003 192.09021293 196.54340628 198 234 C198.20834473 235.28438965 198.20834473 235.28438965 198.42089844 236.59472656 C202.35589432 261.25094779 203.18483978 285.9546499 203.25 310.875 C203.25790054 312.40249374 203.25790054 312.40249374 203.26596069 313.96084595 C203.34901087 334.72192567 201.97157134 355.20494117 198.50537109 375.68481445 C198.12065668 377.9632226 197.75278213 380.2439188 197.38671875 382.52539062 C194.79015151 398.43350164 191.09231176 413.72840465 185.75 428.9375 C185.38867477 429.97624771 185.38867477 429.97624771 185.02005005 431.03598022 C181.2165104 441.95032854 177.14465502 452.63988076 172 463 C171.44626709 464.13187744 171.44626709 464.13187744 170.88134766 465.28662109 C162.99044098 481.28826428 153.59240286 496.40080917 142 510 C141.05312011 511.13128841 140.10652748 512.26281729 139.16015625 513.39453125 C131.04066994 523.04653339 122.67730805 531.87563862 112.7890625 539.76171875 C111.00801742 541.19104485 109.24980181 542.64961957 107.5234375 544.14453125 C86.7301744 562.0087124 61.40902428 573.41281851 36 583 C35.07606445 583.35352539 34.15212891 583.70705078 33.20019531 584.07128906 C26.80460455 586.4699198 20.38111621 588.36952489 13.75 590 C12.71351318 590.25563721 11.67702637 590.51127441 10.60913086 590.7746582 C-4.42477584 594.39559838 -19.59701664 596.80010411 -34.9375 598.6875 C-35.90679443 598.80697998 -36.87608887 598.92645996 -37.87475586 599.04956055 C-51.79184101 600.66613844 -65.68995802 601.20894456 -79.6875 601.1875 C-80.79676346 601.18659363 -80.79676346 601.18659363 -81.92843628 601.18566895 C-94.05452729 601.15893975 -105.97854766 600.65209751 -118 599 C-118.95036133 598.87641113 -119.90072266 598.75282227 -120.87988281 598.62548828 C-165.94613127 592.64228021 -210.14202163 576.32478963 -246 548 C-246.89976562 547.29359375 -247.79953125 546.5871875 -248.7265625 545.859375 C-285.0596778 516.7510002 -309.40777072 479.03447171 -325.92089844 435.79443359 C-326.95030922 433.12867889 -328.02274097 430.48429644 -329.10546875 427.83984375 C-340.83531675 398.56026031 -345.51964344 364.92088382 -347.6875 333.5625 C-347.78130951 332.23046539 -347.78130951 332.23046539 -347.87701416 330.871521 C-352.38454396 265.28993267 -348.37819653 195.96825961 -319 136 C-318.59410645 135.16903809 -318.18821289 134.33807617 -317.77001953 133.48193359 C-287.8874142 72.98568442 -237.55662374 33.25074398 -174.375 11.25 C-171.92090756 10.47127123 -169.47135053 9.7184641 -167 9 C-166.20577637 8.76861328 -165.41155273 8.53722656 -164.59326172 8.29882812 C-148.59483581 3.72190524 -132.42972492 0.5763836 -116 -2 C-114.51258301 -2.24991699 -114.51258301 -2.24991699 -112.99511719 -2.50488281 C-76.2433065 -8.52833872 -36.47290907 -7.24593057 0 0 Z " fill="#FEFEFE" transform="translate(953,137)"/>
<path d="M0 0 C3.24855818 -0.00618936 6.49708487 -0.01605753 9.74563003 -0.02705765 C52.83654362 -0.16482962 52.83654362 -0.16482962 71.27406669 2.18122482 C72.0120342 2.27084456 72.75000171 2.36046431 73.51033187 2.4527998 C111.43681137 7.07491536 149.08464144 17.74411586 174.52406669 47.99372482 C188.60242894 66.43315979 196.19043897 88.39545669 199.27406669 111.18122482 C199.41763602 112.19611984 199.41763602 112.19611984 199.56410575 113.23151779 C203.97574728 149.60779499 201.72807368 191.55816528 178.33656669 221.49372482 C176.99783494 223.06946939 175.64353145 224.63211544 174.27406669 226.18122482 C173.57539481 226.99977951 172.87672294 227.8183342 172.15687919 228.66169357 C159.97862245 242.63851847 145.70295433 252.67733224 129.88344169 262.03669357 C126.52903216 264.02266869 123.20394487 266.05103549 119.89906669 268.11872482 C119.02508231 268.66399826 118.15109794 269.2092717 117.25062919 269.77106857 C115.15165947 271.03571967 115.15165947 271.03571967 114.27406669 273.18122482 C114.87340018 273.28426926 115.47273368 273.38731369 116.0902288 273.49348068 C122.57960876 274.68940492 128.64703797 276.47125425 134.83656669 278.74372482 C135.79039237 279.09378586 136.74421805 279.44384689 137.72694755 279.80451584 C157.06844736 287.10706724 173.40402978 297.88395971 188.27406669 312.18122482 C189.22346122 313.01847092 189.22346122 313.01847092 190.19203544 313.87263107 C208.87748755 330.87151031 219.81395433 358.94390773 224.27406669 383.18122482 C224.54670341 384.62453171 224.54670341 384.62453171 224.82484794 386.09699631 C226.62596221 396.91086722 226.67400868 407.68085351 226.64906669 418.61872482 C226.64785819 419.59610611 226.64664969 420.5734874 226.64540458 421.5804863 C226.49561778 466.17904976 211.10019413 506.35720108 179.52406669 538.36872482 C167.38498023 550.3927844 155.05805522 558.66588728 139.27406669 565.18122482 C138.6003704 565.45950119 137.92667411 565.73777756 137.23256278 566.02448654 C124.95777917 570.96721229 112.21767897 573.6122474 99.27406669 576.18122482 C98.18895804 576.41300682 98.18895804 576.41300682 97.08192801 576.64947128 C90.97636033 577.92879913 84.90598636 578.78759952 78.70375419 579.43513107 C77.22583144 579.59352715 77.22583144 579.59352715 75.71805167 579.75512314 C72.52916061 580.09266301 69.33940499 580.42015929 66.14906669 580.74372482 C65.04418906 580.85583298 63.93931144 580.96794113 62.80095267 581.0834465 C47.88704684 582.5791324 33.06868908 583.84573778 18.07338309 584.0410881 C11.65111546 584.12889883 5.22923538 584.23169602 -1.19265485 584.34378433 C-42.49194852 585.06380077 -83.78897264 585.4508707 -125.09356087 585.69863379 C-130.85482147 585.73337404 -136.61606353 585.7704599 -142.3773005 585.80891037 C-181.49405857 586.06984563 -220.6081051 586.25710179 -259.72593331 586.18122482 C-260.62209003 561.27828269 -260.91313567 536.39610523 -260.99641323 511.47860241 C-261.0149846 506.23059774 -261.03879083 500.98261639 -261.06200814 495.73463058 C-261.10115997 486.74634825 -261.13751049 477.75805861 -261.17176461 468.76975632 C-261.25370751 447.29661233 -261.34732549 425.82351716 -261.44062638 404.35042 C-261.46164632 399.51004944 -261.48244032 394.66967799 -261.50304627 389.82930565 C-261.63471676 358.9515162 -261.79460531 328.07416269 -262.01108956 297.19684982 C-262.02295927 295.49360027 -262.03481982 293.79035066 -262.04667115 292.08710098 C-262.09308354 285.42210748 -262.13974108 278.7571157 -262.18654561 272.09212494 C-262.81794152 182.12167071 -262.83552019 92.15354334 -262.72593331 2.18122482 C-237.08973934 1.91409099 -211.45348714 1.65324418 -185.81716275 1.39892197 C-173.90041158 1.28057263 -161.98368349 1.16049577 -150.06699777 1.03571701 C-100.04549092 0.51313257 -50.0244431 0.07479466 0 0 Z " fill="#FEFEFE" transform="translate(551.7259333133698,810.818775177002)"/>
<path d="M0 0 C1.41308976 0.0012727 1.41308976 0.0012727 2.85472679 0.00257111 C25.36153368 0.02321374 47.86827509 0.05998714 70.375 0.125 C70.63848798 14.18305566 70.8993383 28.24115826 71.15730286 42.29931641 C71.27720641 48.82961215 71.39790021 55.35989114 71.52050781 61.89013672 C71.63917153 68.21197065 71.75561875 74.53384212 71.87063599 80.85574341 C71.91451795 83.24742036 71.95915042 85.63908368 72.00460815 88.0307312 C72.30237453 103.73072352 72.43622673 119.4221601 72.375 135.125 C41.64173707 135.86534868 10.91234456 136.36341199 -19.82830811 136.65722656 C-24.02040601 136.69804399 -28.21247076 136.7418366 -32.40453815 136.78566074 C-36.54793779 136.82874949 -40.69135035 136.87046912 -44.8347683 136.91175652 C-46.75949587 136.93099705 -48.68422066 136.95051796 -50.60894203 136.97036934 C-61.34208492 137.07985221 -72.07380046 137.13594844 -82.80754089 137.12974548 C-83.95065279 137.12940292 -85.09376468 137.12906035 -86.27151632 137.12870741 C-89.05601121 137.1278231 -91.84050543 137.12658137 -94.625 137.125 C-94.38988869 168.51233963 -94.15235729 199.89965991 -93.91170079 231.28695747 C-93.88293 235.03961214 -93.85417868 238.79226696 -93.82543945 242.54492188 C-93.81972053 243.29163291 -93.81400161 244.03834394 -93.8081094 244.80768257 C-93.72260183 255.97789993 -93.63840419 267.14812664 -93.55493164 278.31835938 C-93.4311918 294.86865453 -93.30533107 311.41893251 -93.17666492 327.96919012 C-93.1601212 330.09826096 -93.14362364 332.22733214 -93.12712789 334.35640335 C-92.86509114 368.12335263 -92.55533079 401.88817644 -92.02946711 435.65218544 C-91.55530338 466.14623684 -91.51058645 496.62739975 -91.5625 527.125 C-91.583125 544.615 -91.60375 562.105 -91.625 580.125 C-143.105 580.125 -194.585 580.125 -247.625 580.125 C-248.2348439 569.75765376 -248.78464832 559.51841354 -248.89038086 549.15480042 C-248.90686393 547.85656607 -248.923347 546.55833173 -248.94032955 545.22075695 C-248.9852756 541.67302402 -249.02537411 538.12525149 -249.06457853 534.57745111 C-249.1080173 530.72736969 -249.1561235 526.87734604 -249.2036438 523.02731323 C-249.28527975 516.36409356 -249.3640801 509.70084535 -249.44094849 503.03756905 C-249.5527531 493.349463 -249.66940759 483.66141978 -249.7872442 473.97338545 C-249.97926676 458.17849921 -250.16805059 442.38357609 -250.35449219 426.58862305 C-250.36562683 425.64538352 -250.37676148 424.702144 -250.38823354 423.73032146 C-250.39937897 422.78614844 -250.41052439 421.84197543 -250.42200756 420.86919111 C-250.57903407 407.56732542 -250.73680022 394.26546879 -250.89550781 380.96362305 C-250.90662767 380.03155993 -250.91774752 379.09949682 -250.92920434 378.13918937 C-251.11659183 362.43800099 -251.30562606 346.73683266 -251.49545002 331.03567356 C-251.60144686 322.26052465 -251.70646681 313.48536598 -251.80905151 304.71017647 C-251.92412112 294.86738859 -252.04117608 285.02462614 -252.16015625 275.18188477 C-252.17422284 274.01228995 -252.17422284 274.01228995 -252.1885736 272.81906696 C-252.39898477 255.35518729 -252.63768686 237.89347752 -253.03463745 220.43261528 C-253.61620903 193.62385281 -253.625 166.9752183 -253.625 140.125 C-309.725 140.125 -365.825 140.125 -423.625 140.125 C-423.625 94.585 -423.625 49.045 -423.625 2.125 C-348.67350831 1.59915641 -348.67350831 1.59915641 -321.07177734 1.41357422 C-320.22987861 1.40791052 -319.38797987 1.40224683 -318.52056906 1.39641151 C-305.88009651 1.3114001 -293.23961986 1.22701279 -280.59914005 1.1430887 C-277.88334925 1.12505544 -275.16755858 1.10700205 -272.45176792 1.08894825 C-181.63455556 0.48562212 -90.81970867 -0.08442796 0 0 Z " fill="#FEFEFE" transform="translate(533.625,148.875)"/>
<path d="M0 0 C1.18286213 0.00085602 2.36572426 0.00171204 3.58443069 0.00259399 C18.36880193 0.01407937 33.15315157 0.03429084 47.9375 0.0625 C49.65973965 83.36101422 50.40771078 166.66341513 51.09056997 249.97581416 C51.2024891 263.6232084 51.31550942 277.27059323 51.4296875 290.91796875 C51.43988293 292.13886003 51.45007835 293.35975132 51.46058273 294.6176393 C51.74505517 328.6170666 52.08036087 362.61534227 52.5078125 396.61328125 C52.51956103 397.55120404 52.53130957 398.48912683 52.54341412 399.45547152 C52.7518634 416.08693541 52.96515085 432.71833524 53.19726562 449.3494873 C53.20832777 450.1459428 53.21938992 450.9423983 53.23078728 451.76298881 C53.28159409 455.41898744 53.33294245 459.07497454 53.38571167 462.73094559 C53.96719337 504.1848394 53.9375 545.59555965 53.9375 587.0625 C0.8075 587.0625 -52.3225 587.0625 -107.0625 587.0625 C-107.18367187 574.3471875 -107.30484375 561.631875 -107.4296875 548.53125 C-107.51040269 540.0899242 -107.5911522 531.64859877 -107.67211914 523.20727539 C-107.68252861 522.12199118 -107.69293808 521.03670696 -107.70366299 519.91853535 C-107.77030857 512.97127702 -107.83700689 506.02401919 -107.90374231 499.07676172 C-107.92620547 496.73828971 -107.94866483 494.39981766 -107.97112036 492.06134558 C-108.61711428 424.79256132 -109.28785483 357.52409721 -109.99719238 290.25595093 C-112.23616932 77.9188292 -112.23616932 77.9188292 -112.0625 1.0625 C-74.70722448 0.10941704 -37.36570065 -0.02723199 0 0 Z " fill="#FEFEFE" transform="translate(947.0625,803.9375)"/>
<path d="M0 0 C1.13687256 0.00346436 2.27374512 0.00692871 3.44506836 0.01049805 C15.56714613 0.16631767 26.95778974 1.90394772 38.3125 6.3125 C39.488125 6.72435547 39.488125 6.72435547 40.6875 7.14453125 C67.26282442 16.90265819 84.7186973 40.4840323 96.2121582 65.29418945 C111.41226902 98.93741504 115.50087275 135.88240747 115.49780273 172.46166992 C115.49997839 175.34634416 115.51817861 178.23062782 115.53710938 181.11523438 C115.59330015 199.19307673 114.28436875 217.03266814 110.9375 234.8125 C110.71763428 236.00464111 110.49776855 237.19678223 110.27124023 238.42504883 C108.73233094 246.56581762 106.9698193 254.45566063 104.3125 262.3125 C104.10544434 262.95622559 103.89838867 263.59995117 103.68505859 264.26318359 C94.14451944 293.9087313 77.84461385 321.1842107 49.5 336 C42.96241936 339.21544931 36.38126364 341.56152185 29.3125 343.3125 C27.59546875 343.76109375 27.59546875 343.76109375 25.84375 344.21875 C15.9179257 346.39758948 6.05832528 346.6036666 -4.0625 346.625 C-5.09668564 346.63037781 -5.09668564 346.63037781 -6.15176392 346.63586426 C-34.40779757 346.71484453 -57.1222826 336.45816603 -77.140625 316.91796875 C-88.04207063 305.42571051 -95.58408086 291.8157377 -101.6875 277.3125 C-101.99284668 276.59674805 -102.29819336 275.88099609 -102.61279297 275.14355469 C-111.2145795 254.61499846 -115.18834692 232.3417625 -117.6875 210.3125 C-117.79046387 209.46945312 -117.89342773 208.62640625 -117.99951172 207.7578125 C-121.3055716 179.93050282 -121.54194719 150.09150677 -117.6875 122.3125 C-117.58034668 121.4992627 -117.47319336 120.68602539 -117.36279297 119.84814453 C-112.88574243 86.47554507 -102.27143798 55.04043498 -78.6875 30.3125 C-78.1615625 29.71179688 -77.635625 29.11109375 -77.09375 28.4921875 C-63.34207883 13.40744617 -43.18443757 6.09820781 -23.6875 2.3125 C-22.85839111 2.13517334 -22.02928223 1.95784668 -21.17504883 1.77514648 C-14.07918301 0.33676935 -7.23067642 -0.0359842 0 0 Z " fill="#FD0000" transform="translate(881.6875,261.6875)"/>
<path d="M0 0 C19.57040873 0 19.57040873 0 27.29248047 0.2277832 C28.18437576 0.25222504 29.07627106 0.27666687 29.99519348 0.30184937 C32.86929002 0.38172803 35.74324243 0.4656349 38.6171875 0.55078125 C39.61389591 0.58013449 40.61060432 0.60948772 41.63751602 0.63973045 C46.89582133 0.79540416 52.15399875 0.95483492 57.41210938 1.11694336 C61.7312659 1.2493551 66.0505417 1.37400162 70.37011719 1.49194336 C75.63560537 1.63573159 80.90055137 1.79262928 86.16537857 1.95882225 C88.15457139 2.01950753 90.14390585 2.07573516 92.133358 2.12722206 C111.88480454 2.6454698 111.88480454 2.6454698 121 6 C121.64843369 6.22179932 122.29686737 6.44359863 122.96495056 6.67211914 C137.4080422 11.84644338 148.14994179 20.61321443 154.8125 34.5 C159.07913483 43.93610705 159.33862024 53.20358851 159.3125 63.4375 C159.32861328 64.69626953 159.34472656 65.95503906 159.36132812 67.25195312 C159.36521295 74.69916272 158.7004909 81.04307294 156 88 C155.47019531 89.3921875 155.47019531 89.3921875 154.9296875 90.8125 C148.21631723 104.73652723 137.14554263 113.05542557 122.875 118.25 C95.64347678 127.50805832 65.61034753 126.32994399 37.17901611 126.19561768 C34.22021083 126.18459498 31.26144987 126.18515523 28.30262756 126.18575573 C25.42875878 126.18548448 22.55491971 126.18001671 19.68106079 126.17275429 C17.66913203 126.16807147 15.65719716 126.16630135 13.64526367 126.16459656 C11.82925659 126.15502678 11.82925659 126.15502678 9.9765625 126.14526367 C8.91518066 126.14145187 7.85379883 126.13764008 6.76025391 126.13371277 C4 126 4 126 0 125 C0 83.75 0 42.5 0 0 Z " fill="#FD0101" transform="translate(1355,249)"/>
<path d="M0 0 C3.82279394 0.00576901 7.64551951 0.00223853 11.46831131 -0.00341129 C68.37974012 -0.07616938 68.37974012 -0.07616938 86.79248047 16.63037109 C99.67636942 30.3227632 103.30409936 46.73052617 103.00341797 64.99365234 C102.30798961 80.99884013 94.09714911 95.51868705 82.71044922 106.44287109 C59.69870074 125.45066333 9.86204168 117.26579811 -18.26300049 117.19903564 C-23.13838249 117.18860735 -28.01377011 117.18419728 -32.88916016 117.17919922 C-42.37029413 117.16863348 -51.85140402 117.15168153 -61.33251953 117.13037109 C-61.59520967 104.36836059 -61.856119 91.606315 -62.11482239 78.84422302 C-62.23503309 72.91680132 -62.35583235 66.98939288 -62.47802734 61.06201172 C-62.5961673 55.33023883 -62.71269507 49.59843513 -62.82815552 43.86660767 C-62.87224185 41.69160822 -62.91688641 39.51662001 -62.96212769 37.34164429 C-63.21285204 25.26912033 -63.40192483 13.20579208 -63.33251953 1.13037109 C-42.21626979 0.3295422 -21.1308015 -0.03228309 0 0 Z " fill="#FD0101" transform="translate(515.33251953125,1153.86962890625)"/>
<path d="M0 0 C1.68142727 -0.00322308 3.36285428 -0.0065879 5.04428101 -0.01008606 C8.54547781 -0.01602964 12.04665008 -0.01793069 15.54785156 -0.01733398 C20.00692982 -0.0172321 24.4658498 -0.03093275 28.92489052 -0.04810619 C32.38925891 -0.05928264 35.85358953 -0.06125154 39.31797409 -0.06072426 C40.96121139 -0.06189401 42.60445 -0.06625837 44.24766922 -0.07405663 C62.08874173 -0.15087386 76.58708689 1.81490358 90.0234375 14.69140625 C101.87799157 27.73964806 106.8025727 43.97304655 106.5234375 61.296875 C105.38689418 78.89553797 98.65448888 94.58438075 85.7109375 106.66796875 C75.4389907 115.25713928 61.87646584 115.69813283 49.0234375 116.79296875 C48.26150085 116.85900299 47.49956421 116.92503723 46.71453857 116.99307251 C16.73078459 119.46943808 -13.72959682 118.3403651 -43.7265625 118.16796875 C-43.7265625 80.21796875 -43.7265625 42.26796875 -43.7265625 3.16796875 C-28.93234252 0.89193491 -14.86614229 0.00678452 0 0 Z " fill="#FD0101" transform="translate(491.7265625,923.83203125)"/>
<path d="M0 0 C2.23754082 2.23754082 2.65856712 3.56513642 3.5859375 6.55078125 C3.87484863 7.47036621 4.16375977 8.38995117 4.46142578 9.33740234 C4.76290527 10.31918457 5.06438477 11.3009668 5.375 12.3125 C5.68808105 13.31490723 6.00116211 14.31731445 6.32373047 15.35009766 C7.22210161 18.23149853 8.1123904 21.11526879 9 24 C9.38671875 25.24910156 9.7734375 26.49820313 10.171875 27.78515625 C10.79820537 29.81559609 11.42198188 31.8468258 12.04296875 33.87890625 C13.1617318 37.52744372 14.29798143 41.17040656 15.4375 44.8125 C15.75291748 45.82062744 15.75291748 45.82062744 16.07470703 46.84912109 C16.50269445 48.2166568 16.93075477 49.58416969 17.35888672 50.95166016 C18.40711876 54.30073358 19.45347821 57.65039185 20.5 61 C20.9166574 62.33333623 21.33332407 63.66666956 21.75 65 C44.25 137 44.25 137 44.83979797 138.88746643 C45.45579062 140.85853755 46.07200303 142.82953999 46.68823242 144.80053711 C47.49487869 147.38152966 48.2995869 149.96309527 49.1027832 152.54516602 C51.45906216 160.11150149 53.84625603 167.66718936 56.26171875 175.21484375 C57.11513675 177.88642784 57.96834025 180.55808037 58.8215332 183.22973633 C59.40297903 185.04784056 59.98567905 186.86554412 60.56958008 188.68286133 C61.42896598 191.35902965 62.28327058 194.03677683 63.13671875 196.71484375 C63.39507004 197.51502426 63.65342133 198.31520477 63.91960144 199.13963318 C64.1635817 199.90816116 64.40756195 200.67668915 64.65893555 201.46850586 C64.8703569 202.12862167 65.08177826 202.78873749 65.29960632 203.46885681 C66.35241475 207.27358689 67.1436225 211.14630124 68 215 C26.75 215 -14.5 215 -57 215 C-54.69842243 201.19053459 -54.69842243 201.19053459 -52.9765625 194.4453125 C-52.78911469 193.69643768 -52.60166687 192.94756287 -52.40853882 192.17599487 C-52.01581472 190.61106831 -51.6208387 189.04670518 -51.22363281 187.48291016 C-50.62806333 185.13706594 -50.04000989 182.78943652 -49.453125 180.44140625 C-47.43278655 172.39883796 -45.28044099 164.41397885 -42.96923828 156.44921875 C-41.38796493 150.82195681 -40.01018163 145.14561306 -38.6222229 139.46838379 C-35.97834726 128.66959681 -33.21178898 117.92615561 -30.08081055 107.2565918 C-28.38639716 101.45338536 -26.87226747 95.62251054 -25.4375 89.75 C-23.8448922 83.24097258 -22.09673313 76.81630719 -20.15161133 70.40161133 C-17.78155038 62.46635608 -15.7237557 54.4475672 -13.625 46.4375 C-10.88329688 35.98719473 -8.08741665 25.56038246 -5.0625 15.1875 C-4.63928467 13.73138306 -4.63928467 13.73138306 -4.20751953 12.24584961 C-2.97836317 8.07928806 -1.73240174 3.99205619 0 0 Z " fill="#FD0202" transform="translate(1896,943)"/>
<path d="M0 0 C0.66 0 1.32 0 2 0 C2.35191406 1.2375 2.70382812 2.475 3.06640625 3.75 C7.9855815 21.02199605 13.01000059 38.26280085 18.08618164 55.48925781 C20.20983597 62.70088785 22.31080215 69.91912021 24.4140625 77.13671875 C26.10189054 82.92670276 27.79522643 88.7149836 29.5 94.5 C32.99824922 106.37350346 36.45312276 118.25970379 39.91601562 130.14355469 C42.96194302 140.59558605 46.00905399 151.04716863 49.08642578 161.48999023 C51.20579298 168.68740257 53.30395667 175.89099152 55.40087891 183.0949707 C56.76498364 187.77859693 58.13339875 192.46071653 59.5234375 197.13671875 C59.75353516 197.91208984 59.98363281 198.68746094 60.22070312 199.48632812 C60.64197509 200.90356248 61.06501307 202.3202737 61.49023438 203.73632812 C62.50682132 207.15895475 63.29724765 210.48623825 64 214 C23.08 214 -17.84 214 -60 214 C-59.33790359 207.37903592 -58.62329935 201.65818936 -56.875 195.375 C-56.65980713 194.57795654 -56.44461426 193.78091309 -56.22290039 192.9597168 C-54.10059996 185.18043165 -51.80648435 177.45014936 -49.52368164 169.71679688 C-47.83344289 163.96192533 -46.2314937 158.2027002 -44.8125 152.375 C-42.39587072 142.45463526 -39.52691993 132.69848798 -36.52856445 122.94189453 C-33.61201831 113.44597964 -30.84537331 103.93080841 -28.26782227 94.33740234 C-25.62382676 84.52681038 -22.75984543 74.78341668 -19.89111328 65.03662109 C-19.00346168 62.01179628 -18.12343463 58.9848615 -17.24609375 55.95703125 C-13.51848793 43.09887365 -9.68727777 30.27590115 -5.75927734 17.47753906 C-5.07156111 15.23350551 -4.38818712 12.98821929 -3.70703125 10.7421875 C-3.34996094 9.56914062 -2.99289062 8.39609375 -2.625 7.1875 C-2.32851562 6.21167969 -2.03203125 5.23585938 -1.7265625 4.23046875 C-1 2 -1 2 0 0 Z " fill="#FD0202" transform="translate(1967,280)"/>
<path d="M0 0 C11.57235931 8.97114943 19.63002923 20.69058565 23 35 C23.16910889 35.60424805 23.33821777 36.20849609 23.51245117 36.83105469 C26.66374277 50.85012057 24.32906956 65.35651149 18 78 C17.566875 78.91652344 17.13375 79.83304688 16.6875 80.77734375 C8.67424168 95.87375005 -5.04550773 104.43030722 -20.80859375 109.69140625 C-26.21272895 111.2440638 -31.34124007 111.46007332 -36.9375 111.375 C-38.390354 111.35977295 -38.390354 111.35977295 -39.87255859 111.34423828 C-46.63513768 111.19720091 -52.71527256 110.66319108 -59 108 C-60.46759766 107.39671875 -60.46759766 107.39671875 -61.96484375 106.78125 C-69.51276177 103.35470462 -75.19872979 98.86986632 -81 93 C-81.721875 92.30003906 -82.44375 91.60007812 -83.1875 90.87890625 C-88.84692074 85.03726931 -92.06919079 78.53883666 -95 71 C-95.27070313 70.33661621 -95.54140625 69.67323242 -95.8203125 68.98974609 C-98.14640903 62.82310985 -98.45317248 57.17411677 -98.375 50.625 C-98.38660156 49.66078125 -98.39820312 48.6965625 -98.41015625 47.703125 C-98.34945536 32.60883585 -92.80437214 19.17698519 -82.3359375 8.30859375 C-81.56507813 7.54675781 -80.79421875 6.78492188 -80 6 C-79.31164063 5.28972656 -78.62328125 4.57945312 -77.9140625 3.84765625 C-56.87793289 -16.52376294 -23.48277925 -15.55777958 0 0 Z " fill="#FEF9F9" transform="translate(2218,800)"/>
<path d="M0 0 C0 27.06 0 54.12 0 82 C5.61 82 11.22 82 17 82 C17 70.78 17 59.56 17 48 C29.4432857 48 29.4432857 48 32.67578125 51.19140625 C38.27745184 56.83788025 42.27681527 63.79325151 46.17504883 70.68286133 C48.41355969 74.5979115 50.60752326 78.00701237 54 81 C58.75501836 82.26070927 63.11181835 82.36460849 68 82 C68 82.66 68 83.32 68 84 C54.57515484 93.1482935 41.22727877 97.57776167 25 96 C10.72691613 93.2273038 -2.04286994 85.99926064 -10.6875 74.25 C-19.02868716 61.68108785 -22.31232185 49.05889328 -21 34 C-19.27201778 25.4582697 -11.04218847 0 0 0 Z " fill="#FD0D0D" transform="translate(2148,808)"/>
<path d="M0 0 C9.87020233 8.20271081 17.4919454 21.38170793 19.3515625 34.15234375 C20.23160258 49.90844591 17.24452556 65.86750207 6.3515625 78.15234375 C5.6915625 78.15234375 5.0315625 78.15234375 4.3515625 78.15234375 C3.24169922 76.65869141 3.24169922 76.65869141 2.03125 74.56640625 C1.58217285 73.80465088 1.1330957 73.04289551 0.67041016 72.25805664 C-0.04429443 71.03010376 -0.04429443 71.03010376 -0.7734375 69.77734375 C-7.47267845 57.70635191 -7.47267845 57.70635191 -17.375 48.5234375 C-18.12523438 48.07097656 -18.87546875 47.61851562 -19.6484375 47.15234375 C-19.6484375 46.49234375 -19.6484375 45.83234375 -19.6484375 45.15234375 C-18.92398438 44.94480469 -18.19953125 44.73726562 -17.453125 44.5234375 C-10.87744525 42.42798755 -6.14118526 40.31028928 -2.6484375 34.15234375 C0.10003535 27.23344508 0.76998687 19.65831512 -1.48828125 12.484375 C-4.19463654 7.04432749 -7.94835708 3.36137146 -13.6484375 1.15234375 C-19.56058136 0.08735097 -25.39734972 -0.06074172 -31.39453125 -0.1640625 C-32.40564468 -0.1848436 -33.41675812 -0.20562469 -34.45851135 -0.22703552 C-37.66758863 -0.29207674 -40.87674318 -0.35120352 -44.0859375 -0.41015625 C-46.27019007 -0.45338473 -48.45443502 -0.49700036 -50.63867188 -0.54101562 C-55.9751803 -0.64771115 -61.31176446 -0.74955934 -66.6484375 -0.84765625 C-49.07415608 -19.51931567 -18.46784188 -12.88390738 0 0 Z " fill="#FD0808" transform="translate(2215.6484375,807.84765625)"/>
<path d="M0 0 C0 27.39 0 54.78 0 83 C-10.99179881 73.84016766 -18.48665087 61.42864375 -20 47 C-21.1667235 31.92234245 -17.25621586 18.300411 -7.90625 6.31640625 C-2.46684867 0 -2.46684867 0 0 0 Z " fill="#FD0404" transform="translate(2147,809)"/>
<path d="M0 0 C4.22955053 -0.08093399 8.45755211 -0.1404757 12.6875 -0.1875 C13.88568359 -0.21263672 15.08386719 -0.23777344 16.31835938 -0.26367188 C17.47529297 -0.27333984 18.63222656 -0.28300781 19.82421875 -0.29296875 C20.88729248 -0.3086792 21.95036621 -0.32438965 23.0456543 -0.34057617 C27.37857543 0.1589218 29.96075795 1.96075795 33 5 C33.80123743 11.98221191 33.80123743 11.98221191 30.6875 15.9375 C26.77857377 18.93737362 24.02813257 19.12197022 19.23828125 19.09765625 C18.12001953 19.09443359 17.00175781 19.09121094 15.84960938 19.08789062 C14.68236328 19.07951172 13.51511719 19.07113281 12.3125 19.0625 C11.13365234 19.05798828 9.95480469 19.05347656 8.74023438 19.04882812 C5.82680133 19.03703285 2.91339433 19.01909727 0 19 C0 12.73 0 6.46 0 0 Z " fill="#FD0505" transform="translate(2165,822)"/>
</svg>'

# ---------- Helpers ----------
function Split-And-CleanPhones {
    param([object[]]$Values)

    $raw = @($Values) | Where-Object { $_ -ne $null -and "$_".Trim() -ne "" }

    $raw |
        ForEach-Object { "$_" -split "[`r`n,;|/\\ ]+" } |
        ForEach-Object { $_.Trim() } |
        Where-Object { $_ } |
        ForEach-Object { $_ -replace "[^0-9\+]", "" } |
        Where-Object { $_ } |
        Select-Object -Unique
}

function Get-PhonesFromAD {
    param($User)

    $vals = @()
    if ($User.telephoneNumber) { $vals += $User.telephoneNumber }
    if ($User.otherTelephone)  { $vals += @($User.otherTelephone) }

    Split-And-CleanPhones -Values $vals
}

function PhonesToHtmlCell {
    param([string[]]$Phones)

    if (-not $Phones -or $Phones.Count -eq 0) { return "" }

    #  : 
    if ($Phones.Count -eq 1) {
        return [System.Web.HttpUtility]::HtmlEncode($Phones[0])
    }

    #  :
    #      li
    $first = [System.Web.HttpUtility]::HtmlEncode($Phones[0])
    $rest  = $Phones | Select-Object -Skip 1

    $lis = $rest | ForEach-Object {
        "<li>" + [System.Web.HttpUtility]::HtmlEncode($_) + "</li>"
    }

    return "<div style='white-space:nowrap; font-weight:600;color:red;'>$first</div>" +
           "<ul style='margin:4px 0 0 0; padding-inline-start:18px;'>" + ($lis -join "") + "</ul>"
}

# ---------- XML ----------
$xml  = New-Object System.Xml.XmlDocument
$decl = $xml.CreateXmlDeclaration("1.0","UTF-8",$null)
$xml.AppendChild($decl) | Out-Null

$root = $xml.CreateElement("AddressBook")
$xml.AppendChild($root) | Out-Null

function Add-PbGroup {
    param([int]$id,[string]$name)

    $g = $xml.CreateElement("pbgroup")
    $idNode = $xml.CreateElement("id");   $idNode.InnerText = "$id"
    $nmNode = $xml.CreateElement("name"); $nmNode.InnerText = "$name"
    $g.AppendChild($idNode) | Out-Null
    $g.AppendChild($nmNode) | Out-Null
    $root.AppendChild($g)   | Out-Null
}

Add-PbGroup 1 "Blacklist"
Add-PbGroup 2 "Whitelist"

# ---------- AD Query (NO ipPhone) ----------
$users = Get-ADUser -Filter * -Properties GivenName,Surname,DisplayName,SamAccountName,Enabled,Department,Title,telephoneNumber,otherTelephone |
Where-Object {
    $_.Enabled -eq $true -and
    $_.SamAccountName -notlike "HealthMailbox*" -and
    $_.SamAccountName -notlike "SystemMailbox*" -and
    $_.SamAccountName -notlike "DiscoverySearchMailbox*"
}

# ---------- HTML data collector ----------
$rows = New-Object System.Collections.Generic.List[object]

# ---------- Build Contacts ----------
$id = 1
foreach ($u in $users) {

    $phones = @(Get-PhonesFromAD $u)
    if ($phones.Count -eq 0) { continue }

    $deptOrTitle = if ($u.Department) { $u.Department } elseif ($u.Title) { $u.Title } else { "" }

    Write-Host "Processing:" -ForegroundColor Cyan
    Write-Host "  SamAccountName:" $u.SamAccountName
    Write-Host "  GivenName     :" $u.GivenName
    Write-Host "  Surname       :" $u.Surname
    Write-Host "  Phones        :" ($phones -join ", ")
    Write-Host "-----------------------------"

    $logLine = "{0} | User={1} | GivenName={2} | Surname={3} | Phones={4}" -f `
        (Get-Date), $u.SamAccountName, $u.GivenName, $u.Surname, ($phones -join ", ")
    $logLine | Out-File $logFile -Append -Encoding UTF8

    # --- XML Contact ---
    $contact = $xml.CreateElement("Contact")

    $idNode = $xml.CreateElement("id"); $idNode.InnerText = "$id"
    $contact.AppendChild($idNode) | Out-Null

    $fn = $xml.CreateElement("FirstName"); $fn.InnerText = $(if ($u.GivenName) { $u.GivenName } else { "" })
    $ln = $xml.CreateElement("LastName");  $ln.InnerText = $(if ($u.Surname)   { $u.Surname }   else { "" })
    $contact.AppendChild($fn) | Out-Null
    $contact.AppendChild($ln) | Out-Null

    $fr = $xml.CreateElement("Frequent"); $fr.InnerText = "0"
    $contact.AppendChild($fr) | Out-Null

    # XML phone typing rule:
    # -     => Home
    # -    =>  RingGroup  Phone1, Phone2, ...
    if ($phones.Count -eq 1) {
        $phone = $xml.CreateElement("Phone")
        $phone.SetAttribute("type","Home")

        $pn = $xml.CreateElement("phonenumber"); $pn.InnerText = "$($phones[0])"
        $ai = $xml.CreateElement("accountindex"); $ai.InnerText = "0"
        $phone.AppendChild($pn) | Out-Null
        $phone.AppendChild($ai) | Out-Null
        $contact.AppendChild($phone) | Out-Null
    }
    else {
        for($i=0; $i -lt $phones.Count; $i++){
            $t = if($i -eq 0) { "RingGroup" } else { "Phone$($i)" }  # i=1 => Phone1
            $p = $phones[$i]

            $phone = $xml.CreateElement("Phone")
            $phone.SetAttribute("type",$t)

            $pn = $xml.CreateElement("phonenumber"); $pn.InnerText = "$p"
            $ai = $xml.CreateElement("accountindex"); $ai.InnerText = "0"
            $phone.AppendChild($pn) | Out-Null
            $phone.AppendChild($ai) | Out-Null
            $contact.AppendChild($phone) | Out-Null
        }
    }

    $pr = $xml.CreateElement("Primary"); $pr.InnerText = "0"
    $contact.AppendChild($pr) | Out-Null

    $job = $xml.CreateElement("Job"); $job.InnerText = $deptOrTitle
    $contact.AppendChild($job) | Out-Null

    $root.AppendChild($contact) | Out-Null

    # --- HTML row ---
    $rows.Add([pscustomobject]@{
        Id            = $id
        SamAccountName= $u.SamAccountName
        FirstName     = $(if ($u.GivenName) { $u.GivenName } else { "" })
        LastName      = $(if ($u.Surname)   { $u.Surname }   else { "" })
        Phone         = PhonesToHtmlCell -Phones $phones
        Job           = $deptOrTitle
    }) | Out-Null

    $id++
}

# ---------- Save XML ----------
$xml.Save($outFile)
Write-Host "Done XML: $outFile"

# ---------- Save HTML ----------
$generatedAt = Get-Date

$head = @"
<meta charset="utf-8">
<title>Phonebook</title>
<style>
body{font-family:Segoe UI,Tahoma,Arial;direction:rtl;margin:20px}
table{border-collapse:collapse;width:max-content;margin:auto;text-align:center;}
th,td{border:1px solid #ddd;padding:8px; vertical-align:top}
th{cursor:pointer;position:sticky;top:0;background:#f5f5f5;user-select:none;white-space:nowrap}
th .arrow{font-size:12px;margin-right:6px;color:#666}
tr:nth-child(even){background:#fafafa}
.small{color:#666;font-size:12px;margin-bottom:10px}
input{width:320px;padding:8px;margin:auto;}
a{color:inherit;text-decoration:underline}
td ul{margin:4px 0 0 0; padding-inline-start:18px}
</style>
<script>
let sortState = { col: -1, dir: 1 }; // 1 asc, -1 desc
function cellText(row, idx){
  const td = row.cells[idx];
  if(!td) return "";
  return (td.textContent || "").trim();
}
function sortTable(idx){
  const table = document.getElementById("pb");
  if(!table) return;
  const dataRows = Array.from(table.rows).slice(1);
  if(dataRows.length === 0) return;

  const th = table.rows[0].cells[idx];
  const type = (th && th.getAttribute("data-type")) ? th.getAttribute("data-type") : "text";

  if(sortState.col === idx) sortState.dir *= -1;
  else { sortState.col = idx; sortState.dir = 1; }
  const dir = sortState.dir;

  dataRows.sort((ra, rb) => {
    let a = cellText(ra, idx);
    let b = cellText(rb, idx);
    if(type === "number"){
      const na = parseFloat(a.replace(/[^0-9.\-]/g,"")) || 0;
      const nb = parseFloat(b.replace(/[^0-9.\-]/g,"")) || 0;
      return (na - nb) * dir;
    }
    return a.localeCompare(b, undefined, {numeric:true, sensitivity:"base"}) * dir;
  });

  const frag = document.createDocumentFragment();
  dataRows.forEach(r => frag.appendChild(r));
  table.tBodies.length ? table.tBodies[0].appendChild(frag) : table.appendChild(frag);
  updateSortArrows();
}
function updateSortArrows(){
  const table = document.getElementById("pb");
  if(!table) return;
  const headers = table.rows[0].cells;
  for(let i=0;i<headers.length;i++){
    let arrow = headers[i].querySelector(".arrow");
    if(!arrow){
      arrow = document.createElement("span");
      arrow.className = "arrow";
      headers[i].insertBefore(arrow, headers[i].firstChild);
    }
    if(i === sortState.col){
      arrow.textContent = (sortState.dir === 1) ? "" : "";
    } else {
      arrow.textContent = "";
    }
  }
}
function filterTable(){
  const q = document.getElementById("q").value.toLowerCase();
  const table = document.getElementById("pb");
  if(!table) return;
  const rows = Array.from(table.rows).slice(1);
  for(const r of rows){
    const t = r.innerText.toLowerCase();
    r.style.display = (t.indexOf(q)>-1) ? "" : "none";
  }
}
</script>
"@

$pre = "<div class='small' style='display:flex'><div style='width:4rem;margin-left: 1rem;'>$logosvg</div>Generated: $generatedAt </div><div style='width:100%;margin-block:1rem; text-align:center;'><input id='q' onkeyup='filterTable()' placeholder='...'></div>"
$domain = "@toraibka.co"

$rowsHtml = $rows | ForEach-Object {
    $email = ("{0}{1}" -f $_.SamAccountName, $domain)
    [pscustomobject]@{
        Id        = $_.Id
        FirstName = $_.FirstName
        LastName  = $_.LastName
        Phone     = $_.Phone   #  HTML (div/ul/li) 
        Job       = $_.Job
        Email     = "<a href=""mailto:$email"">$email</a>"
    }
}

# Fragment   encode   
$tbl = ($rowsHtml |
    Sort-Object LastName, FirstName |
    ConvertTo-Html -Fragment -As Table -PreContent $pre -Property Id,FirstName,LastName,Phone,Job,Email
) -join "`n"

$tbl = $tbl -replace "<table>", "<table id='pb'>"
$tbl = $tbl -replace "<th[^>]*>Id</th>",        "<th data-type='number' onclick='sortTable(this.cellIndex)'>Id</th>"
$tbl = $tbl -replace "<th[^>]*>FirstName</th>", "<th data-type='text'   onclick='sortTable(this.cellIndex)'>FirstName</th>"
$tbl = $tbl -replace "<th[^>]*>LastName</th>",  "<th data-type='text'   onclick='sortTable(this.cellIndex)'>LastName</th>"
$tbl = $tbl -replace "<th[^>]*>Phone</th>",     "<th data-type='text'   onclick='sortTable(this.cellIndex)'>Phone</th>"
$tbl = $tbl -replace "<th[^>]*>Job</th>",       "<th data-type='text'   onclick='sortTable(this.cellIndex)'>Job</th>"
$tbl = $tbl -replace "<th[^>]*>Email</th>",     "<th data-type='text'   onclick='sortTable(this.cellIndex)'>Email</th>"

# Decode  ul/li  mailto  HTML   
$tbl = [System.Web.HttpUtility]::HtmlDecode($tbl)

$html = @"
<!doctype html>
<html>
<head>
$head
</head>
<body>
$tbl
<script>updateSortArrows();</script>
<p style="text-align:center;font-size:13px;">
    *      
    <span style="color:red;">
        
    </span>
                        .
    </p>
</body>
</html>
"@

$html | Out-File -FilePath $htmlFile -Encoding UTF8
Write-Host "Done HTML: $htmlFile"

# ---------- Upload to MikroTik (FTP) ----------
$mtIp   = "192.168.1.200"
$mtUser = "admin"
$mtPass = "1376mhn2"

$uri1 = "ftp://$mtIp/cn.xml"

$wc = New-Object System.Net.WebClient
$wc.Credentials = New-Object System.Net.NetworkCredential($mtUser,$mtPass)
$wc.UploadFile($uri1, $outFile) | Out-Null

Write-Host "Uploaded to MikroTik via FTP: $mtIp" -ForegroundColor Green
